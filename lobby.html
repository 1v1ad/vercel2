<!DOCTYPE html>
<meta charset="utf-8">
<title>Лобби</title>
<h1 id="hello">Загрузка…</h1>
<script>
(async () => {
  const token = localStorage.getItem('authToken');
  if (!token) return location.href = '/index.html';

  try{
    const r = await fetch('https://vercel2pr.onrender.com/api/user/profile',{
      headers:{ Authorization:`Bearer ${token}` }
    });
    if (!r.ok) throw new Error(await r.text());

    const u = await r.json();
    document.getElementById('hello').textContent =
      `Привет, ${u.firstName}! Баланс: ${u.balance}`;
  } catch(e){
    alert('Ошибка профиля: ' + e);
    localStorage.removeItem('authToken');
    location.href = '/index.html';
  }
})();
</script>

